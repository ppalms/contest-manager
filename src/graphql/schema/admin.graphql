schema @aws_api_key @aws_lambda {
  query: Query
  mutation: Mutation
}

type Query @aws_api_key @aws_lambda {
  listOrganizations: [Organization]
  getOrganizationWithUsers(id: String!): OrganizationWithUsers
  listContests: [Contest]
  getContest(id: String!): Contest
}

type Mutation @aws_api_key @aws_lambda {
  createOrganization(organization: OrganizationInput!): Organization
  deleteOrganization(id: String!): String
  updateOrganization(organization: UpdateOrganizationInput!): Organization
  saveUser(user: SaveUserInput!): User
  saveContest(contest: SaveContestInput!): Contest
}

# ** Organizations ** #
type Organization @aws_api_key @aws_lambda {
  id: ID!
  name: String!
  type: OrganizationType
}

type OrganizationWithUsers @aws_api_key @aws_lambda {
  organization: Organization!
  users: [User]
}

enum OrganizationType {
  DISTRICT
  NATIONAL
  SCHOOL
  STATE
  UNKNOWN
}

input OrganizationInput {
  id: ID!
  name: String!
  type: OrganizationType!
}

input UpdateOrganizationInput {
  id: ID!
  name: String!
  type: OrganizationType!
}

# ** Users ** #
type User @aws_api_key @aws_lambda {
  id: ID!
  username: String!
  firstName: String!
  lastName: String!
  email: AWSEmail!
  role: UserRole!
  enabled: Boolean!
}

enum UserRole {
  TENANT_ADMIN
  CONTEST_MANAGER
  DIRECTOR
  UNKNOWN
}

input SaveUserInput {
  id: ID
  username: String!
  firstName: String
  lastName: String
  email: AWSEmail
  role: UserRole
  organizationId: ID!
}

# ** Contests ** #
type Contest @aws_api_key @aws_lambda {
  id: ID!
  name: String!
  type: ContestType!
  level: ContestLevel
  startDate: AWSDateTime
  endDate: AWSDateTime
  signUpStartDate: AWSDateTime
  signUpEndDate: AWSDateTime
  manager: User
  entries: [Entry]
}

type Entry @aws_api_key @aws_lambda {
  id: ID!
  directorId: ID!
  musicSelections: [MusicSelection]
}

type MusicSelection @aws_api_key @aws_lambda {
  title: String!
  composerFirstName: String
  composerLastName: String
}

input SaveContestInput {
  id: ID
  name: String!
  type: ContestType!
  level: ContestLevel
  startDate: AWSDateTime
  endDate: AWSDateTime
  signUpStartDate: AWSDateTime
  signUpEndDate: AWSDateTime
}

enum ContestType {
  ORCHESTRA
  MARCHING_BAND
}

enum ContestLevel {
  DISTRICT
  STATE
}
